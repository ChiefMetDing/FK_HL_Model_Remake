# FK_HL_Model_Remake

## Communication Protocols
- DZ is the master of this project. All changes need to be approved by DZ.
- DZ can be reached by email (ding.zhang@kinross.com or ding.zhang.ubcmining@gmail.com) or by Slack.

## Branch Plan
- `ppt`: this branch is used for updating presentation materials.
- `py_da`: this branch is used for data analysis related scripts.
- `vis`: this branch is used for visualization related scripts.
- `ml`: this branch is used for machine learning related scripts.

## Key Files
- `ETL.ipynb` - Read local csv files and upload to database.

- `cells_to_blocks.ipynb` - Read data from database and process the data.

 The script reads in `cells_map.geojson` file. Does stack finish dates and leach dates check to make sure there is no date conflicts. If there are conflicts, cells on a lower elevation, bring their leaching end dates forward so that cells on a higher elevation can stack materials. After conflicts being resolved, the script divide the map in to n x n pieces along latitude and longitude, then remove the pieces do not fall into the heap leach pad. The script uses the remaining pieces to create blocks which inherit gold grade, dates, etc from cells.

- `recovery_remake.ipynb` - Read data generated by `cells_to_blocks.ipynb` and actual gold production. Do recovery calculation on the heap leach pad.

 The script calculates gold recovery from time to time on individual blocks. Then calculates gold production, gold remaining, etc. The script export results into JSON and GeoJSON formatted files for data visualization.

 The script is capable of tuning k factor by using `scipy.optimize.minimize`. Two methods used in this script are 'BFGS' and 'Nelder-Mead'. Documentations can be found below:

  - BFGS: https://docs.scipy.org/doc/scipy/reference/optimize.minimize-bfgs.html#optimize-minimize-bfgs
  - Nelder-Mead: https://docs.scipy.org/doc/scipy/reference/optimize.minimize-neldermead.html#optimize-minimize-neldermead

- `mapping.js` - Visualize heap leach pad by using leaflet and production profile by using plotly.

  - The script visualize cells positions on a leaflet satellite map. There are multiple map layers created.
  - The script also visualize monthly and cumulative gold productions on a line chart.

- `machine_learning.ipynb` - Read data from local csv and perform machine learning on the data.

## Unfinished Functions
- ~~**Parameters Tuning** - Script can compare modeled recovery vs actual recovery and adjust selected parameters to make the modeled data close to the actual production data.~~
- ~~**Life of Pad Remaining Ounces Heat Map** - Add a play button with a fucntion that iterate through all months of the pad life, updating the heat map on the pad to visualize the change of remaining ounces on the pad by location.~~
- **Suggestions** - Provide suggestions on where should be leached next. (check where has the most remaining gold on the pad)

![Fort-Knox-Gold-Pour](https://user-images.githubusercontent.com/78275082/127793123-81dfcf1a-50d3-4d83-b99e-6b777cbf704e.jpg)
